<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Echar gasolina</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="../bootstrap/js/jquery-3.2.0.min.js"></script>
        <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <style>
            #comenzar{
                background: -webkit-radial-gradient(rgba(75,175,75,1),rgba(75,175,75,0.5)); /* For Safari 5.1 to 6.0 */
                background: -o-radial-gradient(rgba(75,175,75,1),rgba(75,175,75,0.5)); /* For Opera 11.6 to 12.0 */
                background: -moz-radial-gradient(rgba(75,175,75,1),rgba(75,175,75,0.5)); /* For Fx 3.6 to 15 */
                background: radial-gradient(rgba(75,175,75,1),rgba(75,175,75,0.5)); /* Standard syntax (must be last) */
            }
            #usuario{
                background-color: rgba(0,0,0,1);
                padding: 0px;
                color: white;
            }
			.textoPreparado{
				display: inline-block;
				white-space: nowrap;
				border: 1px solid blue;
				line-height: 100%;
			}
			body{
				padding: 0px !important;
			}
			div{
				margin: 0px;
				padding: 0px;
			}
        </style>
        <script src="../bootstrap/js/bootstrap.js"></script>
        <script>
            //DESPUES DE CADA FUNCIÓN RESETEAR EL INICIO <--- SI FALLA PUEDE SER POR ESTO
            var volver; var espera = true;
            var letraEspera = true;
            var atras = "index.html";
            var siguiente = "index.html";
            var variables = new Object();
			var ejecutar = function(){};
            $(document).ready(function(){
                var intervalo = setInterval(cambiarLetraEspera, 500);
                $("#contenido").load("manguera.html", function(){ 
                    prepararTexto();
					ajustarTodo();
                    ejecutar();
                });

                $("#comenzar").click(function (){
                    $("#comenzar").fadeOut(1000);
                    inicioTimeOut();

                });
                $("#siguiente").click(function(){
                    $("#contenido").load(siguiente, function(){ 
                        prepararTexto();
						ajustarTodo();
                        ejecutar();
                    });
                });
                $("#atras").click(function(){
                    $("#contenido").load(atras, function(){ 
                        prepararTexto();
						ajustarTodo();
                        ejecutar();
                    });
                });                
            });
            $(window).resize(function(){
                ajustarTodo();                            
            });
           
            function ajustar(elemento){
                var altura = elemento.attr("data-altura");
                var maxAlt = $(window).height();
                altura = maxAlt*altura/100;
//                console.log(elemento.attr("id")+"\nMax Alt:"+maxAlt+"\nAltura:"+altura+"\n");
                elemento.height(altura);
                var margen = elemento.attr("data-margen");
                if(margen!=null){
                    margen = maxAlt*margen/100;
                    elemento.css({
                        marginTop:margen
                    });
                }
            }
            function ajustarMargen(elemento){
                var margen = elemento.attr("data-margen");
                var maxAlt = elemento.parent().height();
                var margen = maxAlt*margen/100;
//                console.log(elemento.html()+"\nMax Alt:"+maxAlt+"\nMargen:"+margen+"\n");
                elemento.css({
                    marginTop: margen
                });
            }
            function ajustarAltura(elemento){
                var altura = elemento.attr("data-altura");
                var maxAlt = elemento.parent().height();
                var altura = maxAlt*altura/100;
//                console.log(elemento.html()+"\nMax Alt:"+maxAlt+"\nAltura:"+altura+"\n");
                elemento.height(altura);
            }
            function actualizarTimeOut(){
                window.clearTimeout(volver);
                inicioTimeOut();
            }
            
            function pararTimeout(){
                window.clearTimeout(volver);
            }
            function inicioTimeOut(){
                volver = setTimeout(inicio, 300000);
            }
            function inicio(){
                window.location.href="index.html";
            }
            function cambiarLetraEspera(){
                if(letraEspera){
                    $("#letraEspera").css({
                        color: "grey" 
                    });
                    letraEspera = !letraEspera;
                }else{
                    $("#letraEspera").css({
                        color: "white"
                    });
                    letraEspera = !letraEspera;
                }
            }
            function ajustarTodo(){
                $(".ajustable").each(function(){
                    ajustar($(this));
                });
                $("#contenido").find(".ajustAlt").each(function(){
                    ajustarAltura($(this));
                });
                $("#contenido").find(".ajustMargen").each(function(){
                    ajustarMargen($(this));
                });
				$("#contenido").find(".textoPreparado").each(function(){
                    ajustarTexto($(this));
                });
                ajustarAltura($("#atras"));
                ajustarAltura($("#siguiente"));
            }
            function add(html){
                $("body").append(html);
            }
            function remove(id){
                $("#"+id).remove();
            }
			// Ajusta el tamaño del texto en funcion del porcentaje pedido
            function ajustarTexto(elemento){			
				var altura = elemento.parent().attr("data-altoTexto");
				var anchura = elemento.parent().attr("data-anchoTexto");
				var maxAlt = elemento.parent().height();
				console.log("a");
				
				var maxAncho = elemento.parent().width() * (anchura / 100);
				//alert(elemento.width());
				var fontSizeEle = elemento.css("font-size").substring(0,elemento.css("font-size").length - 2);
				var anchoEle = elemento.width();// <- error aqui
				
				var fontAlto = (altura * maxAlt) / 100;
				var fontAncho = (maxAncho * fontSizeEle) / anchoEle;
				//console.log(maxAlt+" - "+fontAlto+" - "+fontAncho);
				//console.log(elemento.html()+" -> "+maxAncho+" * "+fontSizeEle+" / "+anchoEle);
				
				if(fontAlto < fontAncho){
					elemento.css({fontSize : fontAlto+"px"});
				}else{
					elemento.css({fontSize : fontAncho+"px"});				
				}	
			
			}
			function prepararTexto(){
				$(".ajustTexto").each(function (){
					$(this).html("<span class='textoPreparado'>"+$(this).html()+"</span>");
				});
			}
        </script>
    </head>
    <body style="overflow: hidden">
<!--    <body>-->
        <div id="comenzar" style=" position:fixed;z-index: 3" data-altura="100" class="ajustable col-md-12 col-sm-12 col-xs-12">
            <div class="col-md-12 col-sm-12 col-xs-12" style="text-align: center; padding-top: 20%">
                <h1 id="letraEspera" style="color: white">Pulse para comenzar</h1>
            </div>
        </div>
        <div id="b_superior" class="ajustable col-md-12 col-sm-12 col-xs-12" data-altura="10" style="background-color: chartreuse">
            
        </div>

        <div id="contenido" class="ajustable col-md-12 col-sm-12 col-xs-12" data-altura="77.5" style="background-color: white; padding: 0px">
            
        </div>
        <div id="b_inferior" class="ajustable col-md-12 col-sm-12 col-xs-12" data-altura="12.5" style="background-color: chartreuse; padding: 0px">
            <div id="atras" class="col-md-1 col-sm-1 col-xs-1" data-altura="100" style="background-color:red">
                atras
            </div>
            <div id="siguiente" class="col-md-1 col-sm-1 col-xs-1 col-md-offset-11 col-sm-offset-11 col-xs-offset-11" data-altura="100" style="background-color:blue; position:absolute; z-index: 2">
                siguiente
            </div>
        </div>
<!--        <div id="usuario" style=" position:fixed;z-index: 2" data-altura="100" class="ajustable col-md-12 col-sm-12 col-xs-12">
            
        </div>-->
    </body>
</html>
